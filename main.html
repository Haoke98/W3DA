<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="ie=edge" http-equiv="X-UA-Compatible">
    <meta content="never" name="referrer">
    <meta content="no-cache, no-store, must-revalidate" http-equiv="Cache-Control"/>
    <link href="./img/W3DAlogo.png" rel="icon">
    <title>W3DA's Main Page</title>
    <style>
        html,
        body {
            height: 100%;
            overflow: hidden;
            background-color: rgba(25, 58, 85, 1);
            align-items: center;
        }

        p {
            margin-top: 2px;
            margin-left: 4px;
        }

        #controlFloor {
            position: absolute;
            z-index: 1;
            width: 100%;
            height: 100%;
            /*border: white solid 1px;*/
        }

        div {
            position: absolute;
            z-index: 1;
            background-color: rgba(55, 55, 55, 1);
            border: black solid 1px;
            width: 9%;
            height: 30%;
            display: flex;
            font-size: 0.5%;
            border-radius: 5px;
            color: #eeeeee;
            opacity: 0.8;
        }

        #tool_bar {
            position: absolute;
            background-color: rgba(55, 55, 55, 1);
            width: 60%;
            height: 5%;
            top: 1%;
            justify-content: space-around;
        }

        #user-share-play-panel {
            position: absolute;
            width: 30%;
            height: 5%;
            top: 1%;
            right: 0.5%;
            display: flex;
            flex-direction: row-reverse;
            /*background-color: ;*/
            justify-content: space-around;
        }

        /*#user-share-play-panel:nth-child(odd){*/
        /*    background-color: #151BFD;*/
        /*}*/
        /*#user-share-play-panel:nth-child(even){*/
        /*    background-color: white;*/
        /*}*/

        #tool_bar img {
            height: 36px;
            width: 36px;
            /*margin-top: 0.1%;*/
            margin-bottom: 0.1%;
            margin-left: 1%;
        }

        #tool_bar img:hover {
            height: 100px;
            width: 100px;
        }

        #tool_bar img:active {
            /*background-color: white;*/
            /*height: 100%;*/
            /*width: 100%;*/
            /*backdrop-filter: blur(10px);*/
            transform: translateY(4px);
        }

        #cube {
            width: 30px;
            height: auto;
            margin-top: 2px;
            margin-left: 20px;
        }

        #ball {
            width: 30px;
            height: 30px;
            margin-top: 4px;
            margin-left: 15px;
        }

        #cylinder {
            width: 40px;
            height: 30px;
            margin-top: 4px;
            margin-left: 16px;
        }

        #yuanzhui {
            width: 35px;
            height: 30px;
            margin-top: 3px;
            margin-left: 16px;
        }

        #yuanbing {
            width: 27px;
            height: 27px;
            margin-top: 4px;
            margin-left: 17px;
        }

        #quxian {
            width: 25px;
            height: 25px;
            margin-top: 4px;
            margin-left: 17px;
        }

        #zhixian {
            width: 30px;
            height: 30px;
            margin-top: 4px;
            margin-left: 17px;
        }

        #square {
            width: 25px;
            height: 25px;
            margin-top: 6px;
            margin-left: 17px;
        }

        #circle {
            width: 30px;
            height: 30px;
            margin-top: 3px;
            margin-left: 17px;
        }

        #geometryPanel {
            right: 0.5%;
            top: 8%;

            flex-direction: column;
        }

        #mapPanel {
            right: 0.5%;
            top: 50%;

            flex-direction: column;
        }

        #objectPanel {
            left: 0.5%;
            top: 8%;

            flex-direction: column;
        }

        #currObjectPanel {
            left: 0.5%;
            top: 50%;
            flex-direction: column;
        }

        #objectPanel:hover, #currObjectPanel:hover {
            width: 12%;
        }

        #geometryPanel:hover {
            width: 12%;
        }

        #mapPanel:hover {
            width: 12%;
        }

        canvas {
            position: absolute;
            z-index: 0;
            top: 0px;
            left: 0px;
            width: 100%;
            height: 100%;

            border: solid 1px;
            background-color: rgba(25, 58, 85, 1);
        }

        .activeObject {
            background-color: orange;
            width: 100%;
            height: 15%;
            border: solid 1px;
        }

        .unActiveObject {
            background-color: rgba(0, 255, 0, 0);
            width: 100%;
            height: 15%;
            border: solid 1px;
        }

        .unActiveObject:hover {
            background-color: rgba(0, 150, 255, 0.5);
            height: 20%;
            transition: background-color .3s;
        }

        .unActiveObject:active {
            background-color: red;
        }

        #btnPlay {
            /*width: 50%;*/
            /*position: absolute;*/
            /*z-index: 1;*/
            /*top: 1%;*/
            /*left: 47%;*/

            width: 36px;
            height: 36px;
            /*background-image: url(img/stop.png);*/
            background-position: center;
            background-repeat: no-repeat;
            background-size: 100%;
        }

        #btnPlay:hover {
            width: 100px;
            height: 100px;
        }


        .leftArea {
            /*left: 50px;*/
            width: max-content;
            height: max-content;
            /*background-color: rebeccapurple;*/
        }

        img {
            width: 100px;
            height: 100px;
            /*padding-bottom: 20%; !* 让div的高等于宽 *!*/
        }

        #btnRemove {
            width: 25px;
            height: 25px;
            margin-bottom: 6px;
            margin-left: 4px;
        }

        #btnRemove:hover {
            width: 50px;
            height: 50px;

        }

        #btnRemove:active {
            background-color: white;
        }

        #objectContainerView, #mapsContainerView, #geometryContainerView2 {
            right: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            overflow: scroll;
        }

        #cameraInfoPanel {
            position: absolute;
            z-index: 1;
            bottom: 20px;
            left: 20px;
            width: 100%;
            height: 50px;

        }

        #mask {
            position: absolute;
            z-index: 2;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.85);
            /*align-items: center;*/
            left: 0;
            /*align-content: center;*/
            /*align-items: center;*/
            /*justify-content: center;*/
            /*justify-items: center;*/
        }

        #mask img {
            /*position: absolute;*/
            /*z-index: 3;*/
            /*top: 50%;*/
            /*left: 50%;*/
            margin: auto;
            background-image: url("https://x.izbasarweb.xyz/static/admin/img/inline-delete.svg");
        }

        #btnExport {
            /*position: absolute;*/
            /*z-index: 1;*/
            width: 36px;
            height: 36px;
            top: 12px;
            right: 60px;
        }

        #btnExport:hover {
            width: 100px;
            height: 100px;
        }

        #btnExport:active {
            transform: translateY(4px);
        }

        #userPage {
            z-index: 1;
            width: 30px;
            height: auto;
            top: 7px;
            right: 12px;
            border: orange solid 2px;
            border-radius: 10px;
        }

        #userPage:hover {
            width: 100px;
            height: 100px;
        }

        #userPage:active {
            transform: translateY(4px);
        }


        #KeyTrack {
            position: absolute;
            /*z-index: ;*/
            top: 86%;
            left: 2%;
            right: 2%;
            width: 96%;
            height: 10%;
            display: flex;
            flex-direction: column;
            align-items: center;

        }

        #KeyTrack input {
            width: 98%;
            height: 60%;
        }

        #KeyTrack view {
            width: 90%;
            height: 30%;
            display: flex;
        }

        #KeyTrack view input {
            width: 20%;
            margin-right: 20%;
            margin-left: 20%;
        }

        .time_line_box {
            position: relative;
            height: 60px;
            overflow: hidden;

        }

        .time_line {
            position: absolute;
            z-index: 1;
            left: 0;
            top: 49px;
            height: 2px;
            background: #dfdfdf;
            -webkit-transition: -webkit-transform 0.4s;
            -moz-transition: -moz-transform 0.4s;
            transition: transform 0.4s;
        }

        .order_item {
            position: absolute;
            bottom: 0;
            z-index: 2;
            text-align: center;
            font-size: 13px;
            padding-bottom: 15px;
            color: #825FFB;
        }

        .order_item:after {
            content: '';
            position: absolute;
            left: 50%;
            right: auto;
            transform: translateX(-50%);
            bottom: -5px;
            height: 10px;
            width: 10px;
            border-radius: 50%;
            border: 2px solid #dfdfdf;
            background-color: #f8f8f8;
        }

        .selected:after {
            background-color: #845FFD;
            border-color: #845FFD;
        }

        .filling_line {
            position: absolute;
            z-index: 1;
            left: 0;
            top: 0;
            height: 100%;
            width: 100%;
            background-color: #845FFD;
            transform-origin: left center;
            transition-property: transform;
            transition-duration: 0.3s;
            transition-timing-function: initial;
            transition-delay: initial;
        }

        .time_tip {
            width: 100%;
            height: 100px;
            line-height: 70px;
            text-align: center;
            color: #151BFD;
            border-bottom: 1px solid #ddd;
        }

        .play {
            background-image: url(img/stop.png);
        }

        .stop {
            background-image: url(img/play.png);
        }

        .geometry {
            width: 90%;
        }

        #codeExporter {
            margin: auto;
            height: 60%;
            width: 80%;
        }

    </style>
    <!--    <link href="css/main.css" rel="stylesheet" type="text/css" />-->
    <!--    <link rel="stylesheet" type="text/css" href="main.css"/>-->
    <script src="./libs/three.min.js"></script>
    <script src="./libs/OrbitControls.js"></script>
    <script src="./libs/stats.min.js"></script>
    <script src="./libs/jquery-3.5.1.min.js"></script>
</head>

<body>

<!--<view id="controlFloor">-->
<!--      <div id="stats-output"></div>-->
<!--  <input type="range" min="10" max="300" value="100" step="10" οnchange="showValue(this.value)" style="">-->
<div id="tool_bar">
    <!--    <img id="cube" src="img/cube.png">-->
    <!--    <img id="ball" src="img/ball.png">-->
    <!--    <img id="cylinder" src="img/cylinder.png">-->
    <!--    <img id="yuanzhui" src="img/yuanzhui.png">-->
    <!--    <img id="yuanbing" src="img/yuanbing.png">-->
    <!--    <img id="quxian" src="img/quxian.png">-->
    <!--    <img id="zhixian" src="img/zhixian.png">-->
    <!--    <img id="square" src="img/square.png">-->
    <!--    <img id="circle" src="img/circle.png">-->
</div>
<div id="user-share-play-panel">
    <a href="W3DA_Page_3.html"><img id="userPage" src="img/me.png"></a>
    <img id="btnExport" onclick="Export()" src="img/export.png">
    <view class="stop" id="btnPlay" onclick="playOrStop()"></view>
</div>

<div id="geometryPanel">
    <p>形状面板</p>
    <view id="geometryContainerView2"></view>
</div>


<div id="mapPanel">
    <p>贴图面板</p>
    <view id="mapsContainerView"></view>
</div>
<!--    <view class="leftArea">-->


<div id="objectPanel">
    <p>已建对象面板</p>
    <!--    <style>-->
    <!--        .ceter {-->
    <!--            width: 700px;-->
    <!--            height: 700px;-->
    <!--            border: 1px solid #F00;-->
    <!--            text-align: center;-->
    <!--            line-height: 700px;-->
    <!--        }-->
    <!--    </style>-->
    <view id="objectContainerView">
    </view>
    <img id="btnRemove" onclick="removeObject()" src="img/del.png">
</div>


<div id="currObjectPanel">
    <curr-object-panel id="curr_object_panel" style="width:100%;height:100%;"></curr-object-panel>
</div>

<!--    <div class="time_line_box">-->
<!--    <div class="time_line" style="width:100%;">-->
<!--        <ol>-->
<!--            <li>-->
<!--                <a class="order_item" style="left:10%;">预约</a>-->
<!--            </li>-->
<!--            <li>-->
<!--                <a class="order_item selected" style="left:25%;">行家确认</a>-->
<!--            </li>-->
<!--            <li>-->
<!--                <a class="order_item" style="left:45%;">付款</a>-->
<!--            </li>-->
<!--            <li>-->
<!--                <a class="order_item" style="left:65%;">见面</a>-->
<!--            </li>-->
<!--            <li>-->
<!--                <a class="order_item" style="left:85%;">评价</a>-->
<!--            </li>-->
<!--        </ol>-->
<!--        <span class="filling_line" style="transform: scaleX(0.28);"></span>-->
<!--    </div>-->
<!--</div>-->
<!--<div class="time_tip">-->
<!--    付款剩余时间：23：58-->
<!--</div>-->
<!--    <progress max="25"></progress>-->
<div id="KeyTrack">
    <input max="25" min="1" onchange="showValue(this.value)" step="1" type="range" value="1"/>
    <view>
        <label>当前帧：</label><input id="curr_key" type="text" value="1">
        <button onclick="setKey()">插入关键帧</button>
    </view>
</div>

<div hidden="hidden" id="mask">
    <img onclick="removeMask()">
    <textarea id="codeExporter">
        1 #this is the code the given to you.\n
        2 #may be its sure.

    </textarea>
</div>


<!--<view id="cameraInfoPanel">this is camera info</view>-->
<!--    </view>-->
<!--</view>-->
<canvas id="webglcanvas"></canvas>

<script src="geometryElements.js"></script>
<script src="tagMaker.js"></script>
<script src="mapPanel.js"></script>
<script src="keyFramePanel.js"></script>
<script src="GUI.js"></script>
<script src="camera.js"></script>
<script src="objectPanel.js"></script>
<script src="controls.js"></script>
<script src="main.js"></script>


<template id="template_currObjectPanel">
    <style>
        :host {
            /*background-color: red;*/
            overflow: hidden;
        }

        :host:hover {
            width: max-content;
            height: max-content;
        }

        .x {
            background-color: rgba(255, 0, 0, 0.5);
        }

        .y {
            background-color: rgba(0, 255, 0, 0.5);
        }

        .z {
            background-color: rgba(0, 0, 255, 0.5);
        }

        p {
            color: orange;
        }

        .objectName {
            background-color: orange;
        }

        input {
            width: 100%;
        }
    </style>
    <p>当前对象</p>
    <input class="objectName" contenteditable="false" id="currObjectName1">
    <label>X:</label>
    <input class="x" id="currObjectX" type="number">
    <label>Y:</label>
    <input class="y" id="currObjectY" type="number">
    <label>Z:</label>
    <input class="z" id="currObjectZ" type="number">
</template>
<script>
    const shadowRoots = new WeakMap();
    class CurrObjectPanel extends HTMLElement {
        constructor() {
            super();
            const shadow = this.attachShadow({mode: 'closed'});
            shadowRoots.set(this, shadow);
        }

        connectedCallBack() {
            const shadow = shadowRoots.get(this);
            var templateElem = document.getElementById('template_currObjectPanel');
            var content = document.importNode(templateElem.content, true);
            content.querySelector('.objectName').setAttribute('value', SELECTED.name);
            var elementX = content.querySelector('.x');
            elementX.setAttribute('value', SELECTED.position.x);
            elementX.addEventListener('change', function (e) {
                SELECTED.position.x = e.target.value;
                activeRenderer();
            });
            var elementY = content.querySelector('.y');
            elementY.setAttribute('value', SELECTED.position.y);
            elementY.addEventListener('change', function (e) {
                SELECTED.position.y = e.target.value;
                activeRenderer();
            });
            var elementZ = content.querySelector('.z');
            elementZ.setAttribute('value', SELECTED.position.z);
            elementZ.addEventListener('change', function (e) {
                SELECTED.position.z = e.target.value;
                activeRenderer();
            });
            shadow.innerHTML = "";
            shadow.appendChild(content);

        }

        click() {
            this.connectedCallBack();
        }

        normalize() {
        }

        blur() {
        }


    }

    window.customElements.define("curr-object-panel", CurrObjectPanel);
</script>
</body>
</html>
